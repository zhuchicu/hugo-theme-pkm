console.log('This site was generated by Hugo.');

// 复制代码功能
document.addEventListener('DOMContentLoaded', function() {
    // 为所有代码块添加复制按钮
    document.querySelectorAll('.highlight').forEach(block => {
        if (!block.querySelector('.copy-code-button')) {
            const button = document.createElement('button');
            button.className = 'copy-code-button';
            button.textContent = '复制';
            button.title = '复制代码';
            
            button.addEventListener('click', async function() {
                const codeElement = block.querySelector('code');
                if (!codeElement) return;
                
                // 克隆code元素以便操作
                const clone = codeElement.cloneNode(true);
                
                // 移除所有行号元素
                clone.querySelectorAll('span[style*="user-select:none"], span[style*="white-space:pre"]').forEach(el => {
                    el.remove();
                });
                
                // 获取纯文本内容
                const cleanCode = clone.textContent.trim();
                
                try {
                    await navigator.clipboard.writeText(cleanCode);
                    const originalText = button.textContent;
                    button.textContent = '已复制!';
                    setTimeout(() => button.textContent = originalText, 2000);
                } catch (err) {
                    console.error('复制失败:', err);
                    button.textContent = '复制失败';
                    setTimeout(() => button.textContent = '复制', 2000);
                }
            });
            
            block.style.position = 'relative';
            block.appendChild(button);
        }
    });
});